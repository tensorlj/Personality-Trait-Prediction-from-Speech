# -*- coding: utf-8 -*-
"""train

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1Yn1dThoWqjwQECVyqt_oe7S2FRK4cuHg
"""

import pandas as pd
from sentence_transformers import SentenceTransformer
import joblib
from sklearn.linear_model import LogisticRegression

df = pd.read_csv('dataset.csv')

embedding_model = SentenceTransformer('paraphrase-multilingual-MiniLM-L12-v2')
sentences = df['transcription'].tolist()
X_embeddings = embedding_model.encode(sentences, show_progress_bar=True)
y_labels = df['classification']

classifier = LogisticRegression()
classifier.fit(X_embeddings, y_labels)

joblib.dump(classifier, 'classifier.joblib')
print("\n Training complete!")

